<link rel="stylesheet" type="text/css" href="project.css">
<h1>User Adder</h1>
<?php {$firstname=$_POST['firstname'];$lastname=$_POST['lastname'];$email=$_POST['email'];if(empty($_POST['emails'])){$emails="FALSE";}else{$emails="TRUE";}if(empty($_POST['notifications'])){$notifications="FALSE";}else{$notifications="TRUE";}if(empty($firstname)){echo "<p>Invalid First Name. <p><a href='index.html'>Return to Home Page</a></p></p>";return;}else{if(!preg_match("#^[a-zA-Z]*$#",$firstname)){echo "<p>Invalid First Name. <p><a href='index.html'>Return to Home Page</a></p></p>";return;}}if(empty($lastname)){echo "<p>Invalid Last Name. <p><a href='index.html'>Return to Home Page</a></p></p>";return;}else{if(!preg_match("#^[a-zA-Z]*$#",$lastname)){echo "<p>Invalid Last Name. <p><a href='index.html'>Return to Home Page</a></p></p>";return;}}if(empty($email)){echo "<p>Invalid Email (somehow). <p><a href='index.html'>Return to Home Page</a></p></p>";return;}if(empty($emails)&&empty($notifications)){echo "<p>Invalid Notifications. Please select at least 1 type. <p><a href='index.html'>Return to Home Page</a></p></p>";return;}$query='SELECT * FROM `users` WHERE `email` = "'.$email.'";';echo $query;require"connect.php";try{$stmt=$pdo->prepare($query);$stmt->execute();while($row=$stmt->fetch()){if(empty($row['Email'])){}else{echo "<p>Account already exists. <p><a href='index.html'>Return to Home Page</a></p></p>";return;}}}catch(Exception $e){echo "<p>Unhandled error occured while checking database.</p>";echo "<p><a href='index.html'>Return to Home Page</a></p>";return;}$query='INSERT INTO `users` (`FirstName`, `LastName`, `Email`, `WantsEmail`, `WantsNotification`) VALUES ("'.$firstname.'", "'.$lastname.'", "'.$email.'", '.$emails.', '.$notifications.');';echo $query;try{$stmt=$pdo->prepare($query);$stmt->execute();echo "<p>User was created!</p>";}catch(Exception $e){echo "<p>Unhandled error occured while adding new user.</p>";}echo "<p><a href='index.html'>Return to Home Page</a></p>";}?>